# HSL_DEV

## Overview
This repo contains python scripts for analyzing MEA electrophysiology data.

Please generate issues in github (here) or email max (jackson.max.e@gmail.com) to report errors, difficulties, comments, and requests. 

## Installation
Download and install Anaconda for Python 2.7, found here: https://www.continuum.io/downloads

Download this repository and unzip it in your directory of choice. 

Double-click on setup.bat to run the setup batch file. 


## Usage
To use these scripts, double click on their associated batch file. Alternatively, open a command line in the script's directory and enter `python script_name.py`. 
For example, to use CV_dev.py, enter `python CV_dev.py`.

Note that these analysis scripts currently analyze text files generated by MC_DataTool - before analyzing a file, be sure to generate its text file via mcd_datatool_gen.bat. 

### Data Conversion
Double-click on the 'mcd_datatool_gen.bat' batch file. 
![alt tag](walkthrough_images/conv_1.png)<br/><br/>

Select a folder for conversion. All subfolders will be converted as well.  
![alt tag](walkthrough_images/conv_2.png)<br/><br/>

This generates a script for MC_DataTool. Double click on the newly-generated .bat file, named after the folder you selected. 
![alt tag](walkthrough_images/conv_3.png)<br/><br/>

MC_DataTool is now running. Check the terminal for progress. 
![alt tag](walkthrough_images/conv_4.png)<br/><br/>

The converted files are generated in the MC_DataTool_Output folder and are ready for use. 
![alt tag](walkthrough_images/conv_5.png)<br/><br/>





### QT Intervals
To run the QT interval script, double-click the 'QT_Dev.bat' batch file.
![alt tag](walkthrough_images/qt_1.png)<br/><br/>

This will open up a dialog to select a file.
The converted files available will be in the MC_DataTool_Output folder.  
![alt tag](walkthrough_images/cv_2.png)<br/><br/>

Select an input file. <br/>
![alt tag](walkthrough_images/cv_3.png)<br/><br/>

The script will then analyze all spikes across the channels and display the average spikes for review.
![alt tag](walkthrough_images/cv_4.png)<br/><br/>

Enter the electrodes you would like to analyze for their QT interval. Press enter to proceed.
![alt tag](walkthrough_images/qt_2.png)<br/><br/>

The first row plots the average spikes for the selected channel. The second row plots all spikes for the channel. 
On the first row, click and drag to select the QT interval. The third row will update to display your selection.
![alt tag](walkthrough_images/qt_3.png)<br/><br/>

Press enter to confirm your selection. The average QT interval is displayed in the terminal. If you entered multiple channels, the script will continue to the next channel. 
![alt tag](walkthrough_images/qt_4.png)<br/><br/>


### Conduction Velocity
To run the conduction velocity script, double-click the 'CV_dev.bat' batch file. 
![alt tag](walkthrough_images/cv_1.png)<br/><br/>

This will open up a dialog to select a file.
The converted files available will be in the MC_DataTool_Output folder.  
![alt tag](walkthrough_images/cv_2.png)<br/><br/>

Select an input file. <br/>
![alt tag](walkthrough_images/cv_3.png)<br/><br/>

The script will then analyze all spikes across the channels and display the average spikes for review.
![alt tag](walkthrough_images/cv_4.png)<br/><br/>

In the command line, enter the two channels you want to analyze for conduction velocity and press enter.
![alt tag](walkthrough_images/cv_5.png)<br/><br/>

The script will plot the two channels on top of each other in the first row and the stimulation channel(if it exists) in the second row. 
Click and drag to select a region in which to calculate conduction velocity. The region for the two channels will update in the bottom two rows based on your selection.
![alt tag](walkthrough_images/cv_6.png)<br/><br/>

Press enter to confirm your selection and to calculate conduction velocity. The average conduction velocity between the two channels in the region you selected is displayed in the terminal.
![alt tag](walkthrough_images/cv_7.png)<br/><br/>

### Principle Component Analysis Graphs
To run the PCA script, double-click on 'spike_pca_dev' batch file. 
![alt tag](walkthrough_images/sp_1.png)<br/><br/>

This will open up a dialog to select a file.
The converted files available will be in the MC_DataTool_Output folder.  
![alt tag](walkthrough_images/cv_2.png)<br/><br/>

Select an input file. <br/>
![alt tag](walkthrough_images/cv_3.png)<br/><br/>

The PCA images are generated and placed in a PCA_Images folder <br/>
![alt tag](walkthrough_images/sp_2.png)<br/><br/>

